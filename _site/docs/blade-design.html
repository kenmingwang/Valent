<!DOCTYPE html>
<html lang=" zh-CN ">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Personal Space Game</title>
    <meta name="viewport" content="width=device-width">
    <link rel="shortcut icon" href="/static/icon.png">
    <link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.12.0/styles/atom-one-dark.min.css">
    <link rel="stylesheet" href="/static/css/main.css">
    <script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
    <script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5e158f966719b70012374cbf&product=inline-follow-buttons" async="async"></script>
    <script type="text/javascript">
        hljs.initHighlightingOnLoad();
    </script>
</head>

<body class="sideNavVisible">
  <div class="fixedHeaderContainer">
  <div class="headerWrapper wrapper">
    <header>
      <a href="/">
        <img class="logo" src="/static/icon.png">
        <h2 class="headerTitle">Personal Space</h2>
      </a>
      <div class="navigationWrapper navigationSlider">
        <nav class="slidingNav">
          <ul class="nav-site nav-site-internal">
            <li>
              <a href="" target="">
                Common Issues
              </a>
            </li>
          </ul>
        </nav>
      </div>
    </header>
  </div>
</div>
  <div class="navPusher">
    <div class="docMainWrapper wrapper">
      <div class="container docsNavContainer" id="docsNav">
        <nav class="toc">
          <div class="toggleNav">
            <section class="navWrapper wrapper">
              <div class="navBreadcrumb wrapper">
                <div class="navToggle" id="navToggler">
                  <i></i>
                </div>
                <h2>
                  <i>›</i>
                  <span>Blade 设计</span>
                </h2>
              </div>
              <div class="navGroups">

                

                
                <div class="navGroup navGroupActive">
                  <h3>介绍</h3>
                  <ul>
                    
                    <li class="navListItem">
                      <a class="navItem" href="why-blade.html">为什么是 Blade ?</a>
                    </li>
                    
                    <li class="navListItem navItemActive">
                      <a class="navItem navItemActive" href="blade-design.html">Blade 设计</a>
                    </li>
                    
                  </ul>
                </div>
                
                <div class="navGroup navGroupActive">
                  <h3>快速入门</h3>
                  <ul>
                    
                    <li class="navListItem">
                      <a class="navItem" href="create-application.html">创建一个工程</a>
                    </li>
                    
                    <li class="navListItem">
                      <a class="navItem" href="create-route.html">创建路由</a>
                    </li>
                    
                    <li class="navListItem">
                      <a class="navItem" href="add-static-file.html">添加静态文件</a>
                    </li>
                    
                    <li class="navListItem">
                      <a class="navItem" href="render-view.html">渲染视图</a>
                    </li>
                    
                  </ul>
                </div>
                
                <div class="navGroup navGroupActive">
                  <h3>指南</h3>
                  <ul>
                    
                    <li class="navListItem">
                      <a class="navItem" href="installation.html">安装 Blade</a>
                    </li>
                    
                    <li class="navListItem">
                      <a class="navItem" href="component.html">组件托管</a>
                    </li>
                    
                    <li class="navListItem">
                      <a class="navItem" href="route.html">路由注册</a>
                    </li>
                    
                    <li class="navListItem">
                      <a class="navItem" href="route-context.html">路由上下文</a>
                    </li>
                    
                    <li class="navListItem">
                      <a class="navItem" href="request.html">HTTP 请求</a>
                    </li>
                    
                    <li class="navListItem">
                      <a class="navItem" href="response.html">HTTP 响应</a>
                    </li>
                    
                    <li class="navListItem">
                      <a class="navItem" href="webhook.html">WebHook</a>
                    </li>
                    
                    <li class="navListItem">
                      <a class="navItem" href="configuration.html">配置文件</a>
                    </li>
                    
                    <li class="navListItem">
                      <a class="navItem" href="templates.html">模板视图</a>
                    </li>
                    
                    <li class="navListItem">
                      <a class="navItem" href="logging.html">日志输出</a>
                    </li>
                    
                    <li class="navListItem">
                      <a class="navItem" href="package-deploy.html">打包部署</a>
                    </li>
                    
                  </ul>
                </div>
                
                <div class="navGroup navGroupActive">
                  <h3>进阶</h3>
                  <ul>
                    
                    <li class="navListItem">
                      <a class="navItem" href="exception.html">异常处理</a>
                    </li>
                    
                    <li class="navListItem">
                      <a class="navItem" href="schedule.html">定时任务</a>
                    </li>
                    
                    <li class="navListItem">
                      <a class="navItem" href="error-page.html">错误页面</a>
                    </li>
                    
                    <li class="navListItem">
                      <a class="navItem" href="listen-event.html">监听事件</a>
                    </li>
                    
                    <li class="navListItem">
                      <a class="navItem" href="session-ext.html">Session 扩展</a>
                    </li>
                    
                    <li class="navListItem">
                      <a class="navItem" href="custom-middleware.html">自定义中间件</a>
                    </li>
                    
                    <li class="navListItem">
                      <a class="navItem" href="cli-args.html">命令行参数</a>
                    </li>
                    
                  </ul>
                </div>
                
              </div>
            </section>
          </div>
          <script>
            var toggler = document.getElementById('navToggler');
            var nav = document.getElementById('docsNav');
            toggler.onclick = function () {
              nav.classList.toggle('docsSliderActive');
            };
          </script>
        </nav>
      </div>
      <div class="container mainContainer">
        <div class="wrapper">
          <div class="post">
            <header class="postHeader">
              <a class="edit-page-link button" href="https://github.com/lets-blade/lets-blade.github.io/edit/master/docs/blade-design.md"
                target="_blank">
                编辑该页
              </a>
              <h1>Blade 设计</h1>
            </header>
            <article>
              <div>
                <p>
                  <h2 id="设计理念">设计理念</h2>

<p>Blade 的设计参考了诸多语言的Web框架，Node 的 <a href="http://expressjs.com/">Express</a>，
Python 的 <a href="http://flask.pocoo.org/">Flask</a>，
Golang 的 <a href="https://github.com/go-macaron/macaron">Martini</a>。</p>

<p>Blade 秉承 <strong>小而美</strong>、<strong>约定优于配置</strong>、<strong>低耦合、可复用</strong>、<strong>提高生产力</strong> 的设计哲学。</p>

<!-- ### 为什么是 Blade? (Why Blade) -->

<!-- 我们举一个计算机之外的例子，假设你准备要去 -->

<p><strong>约定优于配置</strong></p>

<p>Blade 繁多的配置选项在初始状况下都有一个明智的默认值，并会遵循一些惯例。 
例如，按照惯例，模板和静态文件分别存储在 <code class="highlighter-rouge">ClassPath</code> 下面的 <code class="highlighter-rouge">templates</code> 和 <code class="highlighter-rouge">static</code> 目录中。
虽然这个配置可以修改，但你通常不必这么做，尤其是在刚开始的时候。</p>

<h2 id="架构图">架构图</h2>

<center>
    <img src="/static/images/architecture.png" width="400" />
</center>

<h2 id="生命周期">生命周期</h2>

<ol>
  <li>接收客户的请求</li>
  <li>执行中间件（如果有的话）</li>
  <li>执行WebHook（如果有的话）</li>
  <li>执行路由方法</li>
  <li>向客户端发送响应</li>
  <li>移除当前线程Request、Response</li>
</ol>

<h2 id="框架原理">框架原理</h2>

<p>这套框架非常简单，能够让你保持良好的代码风格。为了使用Blade完成功能，你需要了解几个概念。</p>

<p>当开发Blade程序时，你作为开发者的责任，是写出能够迎合用户请求（比如：http://localhost:9000 ）的代码，
并将与请求相对应的资源显示出来。（首页页面）</p>

<p>用户请求所执行的代码，被定义于<strong>控制器类</strong>的方法之中。这些方法被称为<strong>路由</strong>（你也可以理解为SpringMvc中的RequestMapping），
而类则称作controller（控制器，一般会用 <code class="highlighter-rouge">@Path</code> 注解标识）。
用户请求和代码之间的映射关系使用像 <code class="highlighter-rouge">@GetRoute</code> 这样的注解关联。
浏览器显示的内容一般是通过 <code class="highlighter-rouge">templates</code>（模板）来输出的。</p>

<p>在下面章节中你将学习 Blade 控制器、路由、模板中的内部工作流的细节部分。</p>

<p><strong>Controller 和 路由</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Path</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">IndexController</span> <span class="o">{</span>
    
    <span class="nd">@GetRoute</span><span class="o">(</span><span class="s">"/"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">index</span><span class="o">(){</span>
        <span class="k">return</span> <span class="s">"index.html"</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>

<p>在Blade程序中，控制器通常是命名中包含<code class="highlighter-rouge">Controller</code>字样的Java类。</p>

<p>控制器中的方法，被称为路由（Route），它们通常关联着程序中的某个URL，
本例中，<code class="highlighter-rouge">Index</code>控制器只有一个路由名为<code class="highlighter-rouge">/</code>，其对应的方法是<code class="highlighter-rouge">index</code>。</p>

<p>在路由中的代码通常很短，只有10-15行，因为他们只是调用程序的其他部分，
来生成所需的信息，并且负责渲染模板，把结果显示给用户。</p>

<p>在本例中只写了一行，将渲染 <code class="highlighter-rouge">index.html</code>，程序将在 <code class="highlighter-rouge">templates</code> 目录下寻找这个模板文件。</p>

<p><strong>路由</strong></p>

<p>Blade路由把每一个请求递交给对应的方法来执行，这是通过把程序中的配置好的路由路径，来与请求中的URL进行匹配来实现的。</p>

<p><strong>模板</strong></p>

<p>Blade内置了简单的Html模板，但一般不足以应付灵活的Web开发，笔者一般使用 <a href="https://github.com/subchen/jetbrick-template-2x">jetbrick-template</a> 这款模板引擎作为支持。
当然你可以扩展其他你喜欢的模板引擎。</p>

<p>我们使用了 <code class="highlighter-rouge">return "index.html"</code> 告诉程序去寻找 <code class="highlighter-rouge">templates/index.html</code> 模板文件，
你也可以使用 <code class="highlighter-rouge">Response</code> 对象的 <code class="highlighter-rouge">render</code> 方法渲染。</p>

                </p>
              </div>
            </article>
          </div>
          <!-- <div class="docs-prevnext">
            <a class="docs-next button" href="why-prettier.html">Why Prettier? →</a>
          </div> -->
        </div>
      </div>
    </div>
    <script id="twitter-wjs" sync src="https://platform.twitter.com/widgets.js"></script>
<script type="text/javascript" sync src="https://buttons.github.io/buttons.js"></script>

<footer class="footerSection nav-footer" id="footer">
    <section class="sitemap">
        <a href="/" class="nav-home">
            <img src="/static/icon.png" alt="Blade">
        </a>
        <div>
            <h5>Social Media</h5>
            <a href="https://twitter.com/PastelPeaks">@PastelPeaks on Twitter</a>
            <object type="image/svg+xml" data="https://img.shields.io/twitter/follow/PastelPeaks.svg?label=Follow+PastelPeaks&amp;style=social">
                <a href="https://twitter.com/intent/follow?screen_name=PastelPeaks">
                    <img alt="Follow us on Twitter" src="https://img.shields.io/twitter/follow/PastelPeaks.png?label=Follow+PastelPeaks&amp;style=social">
                </a>
            </object>
            <a href="https://www.instagram.com/PersonalSpaceGame/">@PersonalSpaceGame on Instagram</a>
        </div>
        <div>
            <img id="ulogo_pc" src="https://d1ggkj0laysj3f.cloudfront.net/wp-content/uploads/2018/10/29154938/GamerU-white-e1540850013969.png" 
            alt="University of Utah Logo"
            style="width: 25%; float: right;">

            <img id="ulogo_mobile" src="https://d1ggkj0laysj3f.cloudfront.net/wp-content/uploads/2018/10/29154938/GamerU-white-e1540850013969.png" 
            alt="University of Utah Logo"
            style="width: 25%;">
        </div>
    </section>
</footer>

<script>
    function _isMobile() {
        // if we want a more complete list use this: http://detectmobilebrowsers.com/
        // str.test() is more efficent than str.match()
        // remember str.test is case sensitive
        var isMobile = (/iphone|ipod|android|ie|blackberry|fennec/).test
            (navigator.userAgent.toLowerCase());
        return isMobile;
    }

    if (_isMobile()) {
        document.getElementById("ulogo_pc").style.display = "none";
    }
    else {
        document.getElementById("ulogo_mobile").style.display = "none";
    }

</script>
  </div>
</body>

</html>